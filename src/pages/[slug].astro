---
import { getCollection, render } from "astro:content";
import Article from "../layouts/Article.astro";

export async function getStaticPaths() {
    const posts = await getCollection("blog");
    return posts.map((post: any) => {
        const date = post.id.match(/\d{4}-\d{2}-\d{2}/)[0];
        const slug = post.id.replace(/\d{4}-\d{2}-\d{2}-/, "");
        return {
            params: {
                id: post.id,
                description: post.description,
                date,
                slug,
            },
            props: {
                post,
                date: date,
                preamble: post.rendered.metadata.frontmatter?.preamble || ''
            },
        };
    });
}
// 2. For your template, you can get the entry directly from the prop
const { post, date, preamble } = Astro.props;
const { Content } = await render(post);
---

<Article {...post.data} date={date} preamble={preamble}>
    <Content />
</Article>
